# Gsou - Sing-box VPN 客户端

### 一个免费，没广告的代理客户端 - windows 
###### 无需安装(运行需要管员权限，为了使用TUN模式)，不需要设置，打开设置好服务节点就能使用
-    支持ymal节点配置文件导入
-    支持机场远程订阅链接导入
-    支持二维码的扫描导入节点
-    代理协议：Shadowsocks/ShadowTLS/VLESS/AnyTLS/Hysteria2/TUIC/VMess/Trojan
-    支持路由规则设置
-    支持多节点智能分流（可显示哪些节点在用），比如：让 YouTube 走高速节点，日常上网走稳定节点，还可以随意添加更多节点组合

### 最小化窗口后显示悬浮上传下载速度

![最小化悬浮显示上传下载速度](Doc/suspend.gif)

### 主界面

![应用主界面](Doc/main.png)

一个基于 Flutter 开发的 sing-box  客户端，仅支持 Windows 平台。

## 项目简介
Gsou 是一个简单的客户端应用，基于 sing-box 核心构建。

### 主要特性

- **现代化 UI**: 基于 Flutter 构建，支持 Windows 平台
- **系统托盘支持**: 后台运行，系统托盘快速访问
- **多协议支持**: 支持多种代理协议和配置格式
- **灵活配置**: 支持导入配置文件和二维码扫描
- **高性能**: 基于 sing-box 核心

## 系统要求

- **操作系统**: Windows 10 或更高版本
- **Flutter SDK**: >=3.9.2
- **开发工具**: Visual Studio Code / IntelliJ IDEA

## 多节点智能分流使用说明（只有选择：规则 才会生效， 全局不会生效）

用大白话告诉你，如何让不同网站走不同节点：比如"看视频走快节点，聊天走稳定节点"。

### 简单理解

- 你可以创建多个"通道"，每个通道绑定一个节点
- 比如创建"视频通道"、"聊天通道"、"游戏通道"等
- 然后告诉应用：YouTube 走视频通道，微信走聊天通道，Steam 走游戏通道
- 没有特别设置的网站，就走默认通道

### 超简单 3 步设置

#### 步骤 1：创建你的专属通道

- 打开"分流"→"出站绑定"标签页
- 点击"自动生成"可以为每个节点自动创建通道，或者
- 点击"添加出站"手动创建，比如命名为"视频专用"、"游戏专用"等
- 每个通道选择对应的节点，比如"视频专用"选择香港高速节点

#### 步骤 2：告诉哪些网站走哪个通道

- 打开"分流"→"规则管理"
- 点击"添加规则"，举几个例子：
  - 规则1：YouTube、Netflix 等视频网站 → 选择"视频专用"通道
  - 规则2：国内网站（如百度、淘宝）→ 选择"直连"
  - 规则3：其他外国网站 → 选择"游戏专用"通道
- 小贴士：把优先级设成 650 以上，确保你的规则生效

#### 步骤 3：在节点列表看到哪些在用

- 打开"选择节点"页面，被分配任务的节点会"点亮"显示
- 当你真的访问对应网站时，节点状态会显示"已连接"
- 没有流量的通道不会空跑，很省资源

### 几个常见的分流玩法

- **看视频专用线路**：
  - 创建"视频通道"绑定日本高速节点
  - 规则：YouTube、Netflix、B站 → 视频通道
  - 其他网站 → 香港稳定节点

- **游戏加速**：
  - 创建"游戏通道"绑定低延迟节点
  - 规则：Steam、Epic、各种游戏网站 → 游戏通道
  - 日常上网 → 普通节点

- **偷懒模式**：
  - 不想写复杂规则？直接把"默认出站"改成你想要的通道
  - 这样所有网站都走指定节点，简单粗暴

### 怎么知道分流生效了？

- **节点页面看高亮**：
  - 被分配任务的节点会亮起来，表示"我被安排工作了"
  - 有流量时显示"已连接"，没流量时显示"待命"

- **点击主页的（连接时间）可以进入“连接状态”页面看记录**：
  - 能看到哪个网站走了哪个通道
  - 比如"youtube.com → 视频通道"这样的记录

- **悬浮速度看流量**：
  - 观察速度变化，判断哪个节点在干活

### 几个小贴士

- **忘记绑定节点**：如果设置了规则但忘记绑定节点，系统会自动用默认节点，不会断网
- **节点数量不限**：想创建多少个通道就创建多少个，比如专门的"购物通道"、"学习通道"等
- **优先级数字越大越靠前**：自己的规则建议设置 650 以上，这样能覆盖系统默认规则
- **从简单开始**：刚开始不用写太复杂，先设置几个常用的，慢慢完善
 
### 状态管理与存储

- `provider`: ^6.1.2 - 状态管理
- `shared_preferences`: ^2.3.3 - 本地存储

### 文件与网络

- `file_picker`: ^8.1.4 - 文件选择
- `http`: ^1.2.2 - HTTP 请求
- `json_annotation`: ^4.9.0 - JSON 序列化

### 系统集成

- `process_run`: ^1.2.0 - 进程管理
- `path_provider`: ^2.1.5 - 路径处理
- `path`: ^1.9.0 - 路径工具

### 图像处理

- `image`: ^4.2.0 - 图像处理
- `zxing2`: ^0.2.4 - 二维码解析

### 系统 API

- `ffi`: ^2.1.0 - FFI 支持
- `win32`: ^5.5.4 - Windows API 与注册表
- `yaml`: ^3.1.2 - YAML 解析

## 安装与使用

1,  可从发布处下载已以布的版本使用
2， git 本仓库的源码进行进行编译使用


### 开发环境搭建

1. **安装开发环境**

```bash
# 确保 Flutter SDK 版本 >=3.9.2
flutter --version
# go 版本 = go1.23.1 windows/amd64
go version
# msys64
gcc = x86_64-w64-mingw32
```

1. **克隆项目**

```bash
git clone https://github.com/josonxie581/sing_box_vpn.git
cd sing_box_vpn
```


1. **安装依赖**

```bash
flutter pub get
```

1. **编译运行**

```bash
# 调试模式运行
flutter run -d windows

# 发布版本编译
flutter build windows --release
./publish.ps1
```

### 编译 sing-box DLL

项目支持使用本地 sing-tun 源码编译 sing-box DLL：

1. **自动编译**（推荐）

```powershell
# 完整编译
.\build_all.ps1

# 仅编译 DLL（跳过 Flutter）
.\build_all.ps1 -SkipFlutter
```

1. **使用 Dart 脚本**

```bash
dart run tools/prebuild.dart --force
```

详细说明请参考：[LOCAL_SING_TUN_USAGE.md](LOCAL_SING_TUN_USAGE.md)

## 项目结构

```text
sing_box_vpn/
├── lib/                    # Flutter 应用源码
│   ├── main.dart          # 应用入口
│   ├── models/            # 数据模型
│   ├── providers/         # 状态管理
│   ├── screens/           # 页面组件
│   ├── services/          # 服务层
│   ├── theme/             # 主题配置
│   ├── utils/             # 工具函数
│   └── widgets/           # UI 组件
├── assets/                # 资源文件
├── native/                # Go native 代码
├── tools/                 # 构建工具
├── windows/               # Windows 平台特定代码
├── build_all.ps1         # PowerShell 构建脚本
└── pubspec.yaml          # 项目配置文件
```

## 开发指南

### 代码规范

- 遵循 Flutter 官方代码规范
- 使用 `flutter_lints` 进行代码检查
- 保持代码整洁和良好的注释

### 构建流程

1. **预构建**: 处理 native 代码和依赖
2. **资源处理**: 处理图片、字体等资源文件
3. **编译**: Flutter 应用编译
4. **打包**: 生成可执行文件

### 调试技巧

- 使用 `flutter logs` 查看运行日志
- 使用 `flutter inspector` 调试 UI
- 查看 `gsou_daemon.log` 了解后台服务状态

## 贡献指南

欢迎提交 Issue 和 Pull Request 来帮助改进项目。

## 许可证

本项目遵循相应的开源许可证，具体请查看项目中的许可证文件。

## 支持

如果您在使用过程中遇到问题，请：

1. 查看项目文档和常见问题
2. 搜索已有的 Issue
3. 创建新的 Issue 描述问题

---

**注意**: 本项目(所有代码开源仅供学习交流使用)，请遵守当地法律法规。
